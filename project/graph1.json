{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",

  "description": "total green house gas emmisions by source, tonnes of c02",

  "data": {"url": "https://raw.githubusercontent.com/MaxTuu/MaxTuu.GitHub.io/main/project/graph1_pollutionSector_data.json"},

  "mark": {
    "type": "bar", 
    "cornerRadiusBottomRight": 2, 
    "cornerRadiusTopRight": 2,     
    "stroke": "black",
    "cursor": "pointer"
    },


  "transform": [{
    "calculate": "if(datum.Sector === 'Energy' & datum.choice === 'Tonnes of CO2', datum.Value/100000000000, if(datum.Sector === 'Energy' & datum.choice === 'Tonnes of CO2 per capita', datum.Value, 9999999999999))" ,
    "as": "sourceOrder"},

  {"filter": {"param": "choice"}}
  ],

  "params": [
    {
      "name": "choice",
      "select": {"type": "point", "fields":["choice"]},
      "bind": {"input": "select", "options":["Tonnes of CO2","Tonnes of CO2 per capita"]},
      "value" : "Tonnes of CO2 per capita"
    },
    {
      "name": "highlight",
      "select": {"type": "point",  "fields": ["Country"],"on": "mouseover"},
      "value":null
    },
    {
      "name": "select", 
      "select": {"type": "point", "fields": ["Country"]}
      }
  ],


  "encoding": {
    "x": {"field": "Value", "type": "quantitative"},
    "y": {"field": "Country", "type":"nominal", "sort": {"field": "sourceOrder", "order": "descending"}},
    "color": {"field": "Sector"},
    "order": {"field": "sourceOrder"},
    "fillOpacity": {
      "condition": {"param": "select", "value": 1},
      "value": 0.3
    },
    "strokeWidth": {
      "condition": [
        {
          "param": "select",
          "empty": false,
          "value": 1
        },
        {
          "param": "highlight",
          "empty": false,
          "value": 0.5
        }
      ],
      "value": 0
    }
  }
}
